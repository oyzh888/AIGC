<h2>Shape Creator</h2>

<p>Your commands: <input id="command_content" type="text"> </input></p>
<button id="send_commands">Send</button>

<p style="opacity: 0.01;">Count: <input id="count" type="number" value="5"></p>
<button id="create">Create</button>
<button id="cancel">Cancel</button>
<button id="gen_text">GenText</button>
<script>

document.getElementById('create').onclick = () => {
  const textbox = document.getElementById('count');
  const count = parseInt(textbox.value, 10);
  parent.postMessage({ pluginMessage: { type: 'create-shapes', count } }, '*')
}

document.getElementById('cancel').onclick = () => {
  parent.postMessage({ pluginMessage: { type: 'cancel' } }, '*')
}

document.getElementById('gen_text').onclick = () => {
  const text_content = document.getElementById('command_content').value
  // fetch('http://127.0.0.1:5000/modify_title/' + text_content)
  fetch('http://127.0.0.1:5000/generate_ads_text/' + text_content)
  .then((response) => response.text())
  .then(
    (result_str) => {
      parent.postMessage({ pluginMessage: { type: 'gen_text', result_str } }, '*')
    }
  );
}

document.getElementById('send_commands').onclick = async () => {
  const textbox = document.getElementById('command_content');
  const text_content = textbox.value;

  // fetch('http://127.0.0.1:5000/modify_title/this_is_the_title_content_hahahaha')
  fetch('http://127.0.0.1:5000/modify_title/' + text_content)
  // fetch('http://127.0.0.1:5000/generate_ads_text/' + text_content)
  .then((response) => response.text())
  .then(
    (data) => {
      console.log('print data', data)
      var result_str = data;
      parent.postMessage({ pluginMessage: { type: 'send_commands', result_str } }, '*')
    }
  );

}

</script>
